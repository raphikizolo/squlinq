<div fxLayout="column" fxLayoutAlign="start center" class="fit-parent" style="background-color: transparent;">
    <div fxLayout="column" fxLayoutAlign="start stretch" style="background-color: transparent;">
        <div fxLayout="row" fxLayoutAlign="space-around center" style="background-color: transparent;">
            <h2>Fee payment</h2>
        </div>
        <div fxLayout="row" *ngIf="vm && vm.student && vm.person" fxLayoutAlign="space-between"
            style="background-color: transparent;" fxFlex>
            <div fxLayout="column">
                <p class="theme-font-medium-size no-margin">Admission Number</p>
                <p class="theme-font-medium-size no-margin theme-primary-color">{{vm.student.admissionNumber}}</p>
            </div>
            <div fxLayout="column">
                <p class="theme-font-medium-size no-margin">First Name</p>
                <p class="theme-font-medium-size no-margin theme-primary-color">{{vm.person.firstName}}</p>
            </div>
            <div fxLayout="column">
                <p class="theme-font-medium-size no-margin">Middle Name</p>
                <p class="theme-font-medium-size no-margin theme-primary-color">{{vm.person.middleName}}</p>
            </div>
            <div fxLayout="column">
                <p class="theme-font-medium-size no-margin">Surname</p>
                <p class="theme-font-medium-size no-margin theme-primary-color">{{vm.person.surname}}</p>
            </div>
            <mat-icon color="primary" mat-button [matMenuTriggerFor]="create">more_vert</mat-icon>
            <mat-menu #create="matMenu">
                <button mat-menu-item [command]="vm.showFeeStatementComm">
                    <p class="mat-caption">Show fee statement</p>
                </button>
            </mat-menu>
        </div>
        <mat-form-field *ngIf="vm" class="fee-accounts">
            <mat-label>Fee Account</mat-label>
            <mat-select [formControl]="feeAccountsCtrl" (selectionChange)="selectionChanged($event)">
                <mat-option *ngFor="let t of vm.feeAccounts | async" [value]="t">{{t.description}}</mat-option>
            </mat-select>
        </mat-form-field>
        <div *ngIf="selectedFeeAccount" style="overflow: visible;">
            <table #table mat-table [dataSource]="selectedFeeAccount" class="mat-elevation-z8">
                <ng-container *ngFor="let col of selectedFeeAccount.headersVm.columnNames; let colIndex = index"
                    matColumnDef="{{col}}">
                    <th mat-header-cell *matHeaderCellDef>{{col | fieldNameToSentCase }}</th>
                    <td mat-cell *matCellDef="let element">
                        <div *ngIf="col != 'amount'" class="item-cont">{{element[col]}}</div>
                        <div fxLayout="column" fxLayoutAlign="end stretch" *ngIf="col == 'amount'" style="height: 7em;">
                            <mat-form-field class="input">
                                <mat-label>Amount</mat-label>
                                <input type="text" matInput [formControl]="element['amountFormControl']"
                                    placeholder="Enter amount">
                                <mat-error *ngIf="element['amountFormControl']?.hasError('required')">Amount is
                                    required</mat-error>
                                <mat-error *ngIf="element['amountFormControl']?.hasError('min')">Value entered is too
                                    small</mat-error>
                            </mat-form-field>
                        </div>
                    </td>
                </ng-container>
                <tr mat-header-row *matHeaderRowDef="selectedFeeAccount.headersVm.columnNames"></tr>
                <tr mat-row *matRowDef="let row; columns: selectedFeeAccount.headersVm.columnNames;"></tr>
            </table>
            <div fxLayout="row" fxLayoutAlign="space-around center">
                <mat-form-field>
                    <mat-label>Posted date</mat-label>
                    <input matInput [matDatepicker]="picker" [formControl]="postedDateCtrl">
                    <mat-hint>DD/MM/YYYY</mat-hint>
                    <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                    <mat-datepicker #picker></mat-datepicker>
                </mat-form-field>

            </div>
            <div fxLayout="column" fxLayoutAlign="end stretch" style="height: 7em;">
                <mat-form-field class="input">
                    <mat-label>Comment</mat-label>
                    <input type="text" matInput [formControl]="selectedFeeAccount.commentFormCtrl" placeholder="Enter Comment">
                </mat-form-field>
            </div>
            <div fxLayout="row" fxLayoutAlign="space-around center">
                <p class="total-desc">Total Payable</p>
                <p class="total-desc">{{selectedFeeAccount.totalExpected | async}}</p>
            </div>
            <div class="total-desc" fxLayout="row" fxLayoutAlign="space-around center">
                <p>Total</p>
                <p>{{selectedFeeAccount.total | async}}</p>
                <button mat-flat-button [command]="selectedFeeAccount.submitComm"
                    [disabled]="((selectedFeeAccount.total | async) || 0) < 50">Submit</button>
            </div>

        </div>

    </div>


</div>